{% extends "base.html" %}

{% block content %}
<div id="journal_container" class="{{ mode_styler.background_class }}">

<div class="max-w-3xl mx-auto px-4 py-8">

  {% include "journal/_mode_banner.html" with mode=mode %}

  <div class="p-4 bg-gray-100 rounded-md">
  <label for="mode-select" class="block text-sm font-medium text-gray-700 mb-2">
    Select Mode
  </label>
  <select 
    id="mode-select"
    name="slug"
    class="w-full border border-gray-300 rounded px-3 py-2"
    hx-post="{% url 'journal:_synth_button' %}" 
    hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'
    hx-trigger="change"
    hx-target="#synthesize-button-wrapper"
    hx-swap="outerHTML"
  >
    <option disabled selected>Choose a mode...</option>
    {% for m in modes %}
      <option value="{{ m.slug }}">{{ m.name }}</option>
    {% endfor %}
  </select>
</div>


  <h2 class="text-2xl font-bold mb-6 text-center">🪞 EchoJournal Dashboard</h2>

  {% include "journal/_customize_links.html" %}
  
  <div id="current-mode">
    {% include "journal/_current_mode.html" with mode=mode %}
  </div>

  <button 
    hx-get="{% url 'journal:mode_selector' %}" 
    hx-target="#mode-selector" 
    hx-swap="innerHTML"
    class="btn btn-outline-secondary mt-2"
  >
    Change Mode
  </button>
  <div id="mode-selector" class="mt-2"></div>

  {% include "journal/journal_form.html" %}

  {% include "journal/_entry_filter.html" %}

  <div id="journal-entry-list" class="mt-10">
    <hr class="my-6 border-gray-300">
    <h3 class="text-lg font-semibold mb-4">📝 Today's Entries</h3>
    <div id="entry-list" 
         hx-get="{% url 'journal:same_day_entries' %}" 
         hx-trigger="load" 
         class="space-y-4">
    </div>
  </div>

  {% include "journal/_synthesis.html" %}
  <div id="synthesize-button-wrapper">
  {% include "journal/_synthesize_button.html" %}
</div>

</div>
<!-- </div> -->
{% endblock %}